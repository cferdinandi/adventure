/*! adventure v1.0.0 | (c) 2020 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/adventure */
!function(){"use strict";var e,t,n,r,o=document.querySelector("#new-game"),a=document.querySelector("#app"),i=document.querySelector("#controls"),u=function(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),t=e[r-=1],e[r]=e[n],e[n]=t},c=function(){var e=document.createElement("div");return e.setAttribute("tabindex","-1"),e},d=function(e){var t=c();return t.innerHTML="<h2>"+n+". "+e.title+"</h2><p>"+e.description+"</p><p><em>There are "+r.party*e.count+" "+e.title+"</em></p><p>Attack "+e.attack+" · Defend "+e.defend+" · HP "+e.hp+"</p>",t},s=function(e){var t=c();return t.innerHTML="<h2>"+n+". "+e.title+"</h2><p>"+e.description+"</p>",t},p=function(){u(e);var t=function(e){var t=c();return t.innerHTML="<h2>"+e.title+"</h2><p>"+e.description+"</p><p><em><strong>Note:</strong> your progress is automatically saved as you play, so you can leave and come back later if you need to.</em></p>",t}(e[0]),n=s(e[0].firstEncounter);a.appendChild(t),a.appendChild(n),t.focus()},l=function(e){i.innerHTML=e?'<p><button class="btn" data-reset-game>End the Game</button></p>':'<p><button class="btn" data-next-encounter>Next Encounter</button> <a data-reset-game role="button" href="#">Or end the game...</a></p>'},h=function(o){var i;o.target.hasAttribute("data-next-encounter")&&(++n===r.duration?(i=e[0].lastEncounter.isMonster?d(e[0].lastEncounter):s(e[0].lastEncounter),l(!0)):(u(t),i=t[0].isMonster?d(t[0]):s(t[0]),t=t.slice(1)),a.appendChild(i),i.focus())},m=function(e){e.target.hasAttribute("data-reset-game")&&(e.preventDefault(),window.confirm("Are you sure you want to end the game?")&&(i.innerHTML="",a.innerHTML="",o.removeAttribute("hidden"),o.focus()))};o.addEventListener("submit",(function(){var a;event.preventDefault(),e=[{title:"Save a prince from a dragon",description:"The young prince accidentally wandered into a dragon's lair while exploring an abandoned castle deep in the woods. The dragon is very much enjoying his company, and does not want to let him go. The Queen has begged you to rescue her prince and bring him home.",firstEncounter:{title:"Gather supplies and head out",description:"What supplies might you need for this encounter? Put together a plan, and acquire the needed supplies. Then, head to the castle!<br><br><em><strong>Note for the GM:</strong> you may wish to roleplay a shopkeep to provide the adventurers with their needed supplies.</em>"}}],a=[].map((function(e){return e.isMonster=!0,e})),t=[].concat(a),n=1,r={duration:parseFloat(document.querySelector('[name="duration"]:checked').value),party:parseInt(document.querySelector("#party").value,10),style:document.querySelector('[name="style"]').value},p(),l(),o.setAttribute("hidden","")})),document.addEventListener("click",(function(e){h(e),m(e)}))}();
